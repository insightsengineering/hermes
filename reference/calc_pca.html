<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Principal Components Analysis Calculation — calc_pca • hermes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Components Analysis Calculation — calc_pca"><meta property="og:description" content="
The calc_pca() function performs principal components analysis of the gene count
vectors across all samples.
A corresponding autoplot() method then can visualize the results."><meta property="og:image" content="https://insightsengineering.github.io/hermes/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hermes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.5.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/hermes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/insightsengineering/hermes" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Principal Components Analysis Calculation</h1>
    <small class="dont-index">Source: <a href="https://github.com/insightsengineering/hermes/blob/HEAD/R/pca.R" class="external-link"><code>R/pca.R</code></a></small>
    <div class="hidden name"><code>calc_pca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>The <code>calc_pca()</code> function performs principal components analysis of the gene count
vectors across all samples.</p>
<p>A corresponding <code>autoplot()</code> method then can visualize the results.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calc_pca</span><span class="op">(</span><span class="va">object</span>, assay_name <span class="op">=</span> <span class="st">"counts"</span>, n_top <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>(<code>AnyHermesData</code>) <br> input.</p></dd>
<dt>assay_name</dt>
<dd><p>(<code>string</code>) <br> name of the assay to use.</p></dd>
<dt>n_top</dt>
<dd><p>(<code>count</code> or <code>NULL</code>)<br> filter criteria based on number of genes with maximum variance.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A HermesDataPca object which is an extension of the <a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp</a> class.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<ul><li><p>PCA should be performed after filtering out low quality genes and samples, as well as
normalization of counts.</p></li>
<li><p>In addition, genes with constant counts across all samples are excluded from
the analysis internally in <code>calc_pca()</code>. Centering and scaling is also applied internally.</p></li>
<li><p>Plots can be obtained with the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">ggplot2::autoplot()</a></code> function
with the corresponding method from the <code>ggfortify</code> package to plot the
results of a principal components analysis saved in a <code>HermesDataPca</code>
object. See <code><a href="https://rdrr.io/pkg/ggfortify/man/autoplot.pca_common.html" class="external-link">ggfortify::autoplot.prcomp()</a></code> for details.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Afterwards correlations between principal components
and sample variables can be calculated, see <code><a href="pca_cor_samplevar.html">pca_cor_samplevar</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">hermes_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="quality_flags.html">add_quality_flags</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="filter.html">filter</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="normalize.html">normalize</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">calc_pca</span><span class="op">(</span><span class="va">object</span>, assay_name <span class="op">=</span> <span class="st">"tpm"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="summary.html">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of first k=18 (out of 19) components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC1     PC2     PC3      PC4      PC5     PC6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     22.9971 18.7315 16.3042 13.47009 13.05843 11.4881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.2212  0.1467  0.1112  0.07589  0.07132  0.0552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.2212  0.3679  0.4791  0.55500  0.62632  0.6815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             PC7     PC8     PC9    PC10    PC11    PC12    PC13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     10.60653 9.67291 9.29607 8.97324 8.54474 8.11786 7.70847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.04705 0.03913 0.03614 0.03368 0.03054 0.02756 0.02485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.72857 0.76770 0.80384 0.83752 0.86805 0.89562 0.92047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC14    PC15    PC16    PC17    PC18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     7.20798 6.91976 6.11309 5.77360 4.42960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.02173 0.02003 0.01563 0.01394 0.00821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.94220 0.96222 0.97785 0.99179 1.00000</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu">calc_pca</span><span class="op">(</span><span class="va">object</span>, assay_name <span class="op">=</span> <span class="st">"tpm"</span>, n_top <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="summary.html">summary</a></span><span class="op">(</span><span class="va">result1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of first k=18 (out of 19) components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC1    PC2     PC3     PC4     PC5     PC6     PC7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     11.2652 9.6518 6.89353 6.34548 5.29254 5.20812 4.70857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.2538 0.1863 0.09504 0.08053 0.05602 0.05425 0.04434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.2538 0.4401 0.53517 0.61570 0.67172 0.72597 0.77031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC8     PC9   PC10    PC11   PC12    PC13    PC14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     4.2012 4.06409 3.7884 3.51647 3.2405 3.07753 3.04570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.0353 0.03303 0.0287 0.02473 0.0210 0.01894 0.01855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.8056 0.83864 0.8673 0.89208 0.9131 0.93202 0.95058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC15    PC16    PC17    PC18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     2.87077 2.65226 2.46289 1.83598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.01648 0.01407 0.01213 0.00674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.96706 0.98113 0.99326 1.00000</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the results.</span></span>
<span class="r-in"><span class="fu">autoplot</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calc_pca-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">autoplot</span><span class="op">(</span><span class="va">result</span>, x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calc_pca-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">autoplot</span><span class="op">(</span><span class="va">result</span>, variance_percentage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calc_pca-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">autoplot</span><span class="op">(</span><span class="va">result</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, label.repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calc_pca-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Sabanés Bové, Namrata Bhatia, Stefanie Bienert, Benoit Falquet, Haocheng Li, Jeff Luong, Lyndsee Midori Zhang, Simona Rossomanno, Tim Treis, Mark Yan, Naomi Chang, Chendi Liao, Carolyn Zhang, Joseph N. Paulson, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

