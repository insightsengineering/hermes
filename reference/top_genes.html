<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Derivation of Top Genes — top_genes • hermes</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Derivation of Top Genes — top_genes" />
<meta property="og:description" content="
top_genes() creates a HermesDataTopGenes object, which extends data.frame. It
contains two columns:
expression: containing the statistic values calculated by summary_fun across columns.
name: the gene names.


The corresponding autoplot() method then visualizes the result as a barplot." />
<meta property="og:image" content="https://insightsengineering.github.io/hermes/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hermes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction to `hermes`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/insightsengineering/hermes">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Derivation of Top Genes</h1>
    <small class="dont-index">Source: <a href='https://github.com/insightsengineering/hermes/blob/master/R/top_genes.R'><code>R/top_genes.R</code></a></small>
    <div class="hidden name"><code>top_genes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a></p>
<p><code>top_genes()</code> creates a <code>HermesDataTopGenes</code> object, which extends <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code>. It
contains two columns:</p><ul>
<li><p><code>expression</code>: containing the statistic values calculated by <code>summary_fun</code> across columns.</p></li>
<li><p><code>name</code>: the gene names.</p></li>
</ul>

<p>The corresponding <code><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot()</a></code> method then visualizes the result as a barplot.</p>
    </div>

    <pre class="usage"><span class='fu'>top_genes</span><span class='op'>(</span>
  <span class='va'>object</span>,
  assay_name <span class='op'>=</span> <span class='st'>"counts"</span>,
  summary_fun <span class='op'>=</span> <span class='va'>rowMeans</span>,
  n_top <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>min_threshold</span><span class='op'>)</span><span class='op'>)</span> <span class='fl'>10L</span> <span class='kw'>else</span> <span class='cn'>NULL</span>,
  min_threshold <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for HermesDataTopGenes</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  x_lab <span class='op'>=</span> <span class='st'>"HGNC gene names"</span>,
  y_lab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>@</span><span class='va'>summary_fun_name</span>, <span class='st'>"("</span>, <span class='va'>object</span><span class='op'>@</span><span class='va'>assay_name</span>, <span class='st'>")"</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='st'>"Top most expressed genes"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>(<code>AnyHermedData</code>)<br /> input.</p></td>
    </tr>
    <tr>
      <th>assay_name</th>
      <td><p>(<code>string</code>)<br /> name of the assay to use for the sorting of genes.</p></td>
    </tr>
    <tr>
      <th>summary_fun</th>
      <td><p>(<code>function</code>)<br /> summary statistics function to apply across the samples in
the assay resulting in a numeric vector with one value per gene.</p></td>
    </tr>
    <tr>
      <th>n_top</th>
      <td><p>(<code>count</code> or <code>NULL</code>)<br /> selection criteria based on number of entries.</p></td>
    </tr>
    <tr>
      <th>min_threshold</th>
      <td><p>(<code>number</code> or <code>NULL</code> )<br /> selection criteria based on a minimum
summary statistics threshold.</p></td>
    </tr>
    <tr>
      <th>x_lab</th>
      <td><p>(<code>string</code>)<br /> x-axis label.</p></td>
    </tr>
    <tr>
      <th>y_lab</th>
      <td><p>(<code>string</code>)<br /> y-axis label.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>(<code>string</code>)<br /> plot title.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A HermesDataTopGenes object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<ul>
<li><p>The data frame is sorted in descending order of <code>expression</code> and only the top
entries according to the selection criteria are included.</p></li>
<li><p>Note that exactly one of the arguments <code>n_top</code> and <code>min_threshold</code> must be
provided.</p></li>
</ul>

    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>autoplot,HermesDataTopGenes-method</code>: Creates a bar plot from a HermesDataTopGenes object,
where the y axis shows the expression statistics for each of the top genes
on the x-axis.</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='va'>object</span> <span class='op'>&lt;-</span> <span class='va'>hermes_data</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Default uses average of raw counts across samples to rank genes.</span></span>
<span class='r-in'><span class='fu'>top_genes</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Object of class "HermesDataTopGenes"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>              expression         name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:2335   390085.60  GeneID:2335</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:79026  302684.20 GeneID:79026</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:4627    60247.10  GeneID:4627</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:667     59502.90   GeneID:667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:26986   58479.75 GeneID:26986</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:6218    57782.15  GeneID:6218</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:6205    50484.85  GeneID:6205</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:811     42460.70   GeneID:811</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:23215   41407.95 GeneID:23215</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:4035    35884.20  GeneID:4035</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Slot "summary_fun_name":</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "rowMeans"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Slot "assay_name":</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "counts"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Instead of showing top 10 genes, can also set a minimum threshold on average counts.</span></span>
<span class='r-in'><span class='fu'>top_genes</span><span class='op'>(</span><span class='va'>object</span>, n_top <span class='op'>=</span> <span class='cn'>NULL</span>, min_threshold <span class='op'>=</span> <span class='fl'>50000</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Object of class "HermesDataTopGenes"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>              expression         name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:2335   390085.60  GeneID:2335</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:79026  302684.20 GeneID:79026</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:4627    60247.10  GeneID:4627</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:667     59502.90   GeneID:667</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:26986   58479.75 GeneID:26986</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:6218    57782.15  GeneID:6218</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> GeneID:6205    50484.85  GeneID:6205</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Slot "summary_fun_name":</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "rowMeans"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Slot "assay_name":</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "counts"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># We can also use the maximum of raw counts across samples, by specifying a different</span></span>
<span class='r-in'><span class='co'># summary statistics function.</span></span>
<span class='r-in'><span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>top_genes</span><span class='op'>(</span><span class='va'>object</span>, summary_fun <span class='op'>=</span> <span class='va'>rowMax</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Finally we can produce barplots based on the results.</span></span>
<span class='r-in'><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>result</span>, title <span class='op'>=</span> <span class='st'>"My top genes"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='top_genes-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>result</span>, y_lab <span class='op'>=</span> <span class='st'>"Counts"</span>, title <span class='op'>=</span> <span class='st'>"My top genes"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='top_genes-2.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanés Bové, Namrata Bhatia, Stefanie Bienert, Benoit Falquet, Haocheng Li, Jeff Luong, Lyndsee Midori Zhang, Simona Rossomanno, Tim Treis, Mark Yan, Naomi Chang, Chendi Liao, Carolyn Zhang, Joseph N. Paulson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


