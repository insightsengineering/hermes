<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hermes">
<title>Introduction to `hermes` • hermes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `hermes`">
<meta property="og:description" content="hermes">
<meta property="og:image" content="https://insightsengineering.github.io/hermes/main/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hermes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9014</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/hermes.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/hermes">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to `hermes`</h1>
                        <h4 data-toc-skip class="author">Daniel Sabanés
Bové</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:daniel.sabanes_bove@roche.com" class="email">daniel.sabanes_bove@roche.com</a>
      
                              <h4 data-toc-skip class="author">Namrata
Bhatia</h4>
                        <h4 data-toc-skip class="author">Stefanie
Bienert</h4>
                        <h4 data-toc-skip class="author">Benoit
Falquet</h4>
                        <h4 data-toc-skip class="author">Haocheng
Li</h4>
                        <h4 data-toc-skip class="author">Jeff Luong</h4>
                        <h4 data-toc-skip class="author">Lyndsee Midori
Zhang</h4>
                        <h4 data-toc-skip class="author">Alex
Richardson</h4>
                        <h4 data-toc-skip class="author">Simona
Rossomanno</h4>
                        <h4 data-toc-skip class="author">Tim Treis</h4>
                        <h4 data-toc-skip class="author">Mark Yan</h4>
                        <h4 data-toc-skip class="author">Naomi
Chang</h4>
                        <h4 data-toc-skip class="author">Chendi
Liao</h4>
                        <h4 data-toc-skip class="author">Carolyn
Zhang</h4>
                        <h4 data-toc-skip class="author">Joseph N.
Paulson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/hermes/blob/HEAD/vignettes/hermes.Rmd" class="external-link"><code>vignettes/hermes.Rmd</code></a></small>
      <div class="d-none name"><code>hermes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p><code>hermes</code> is a successor of the Roche internal
<code>rnaseqTools</code> R package, and therefore many code ideas have
been borrowed from it. Therefore we would like to thank the
<code>rnaseqTools</code> authors for their work.</p>
<p>In particular, we would like to acknowledge Chendi Liao and Joe
Paulson for their guidance and explanations during the development of
<code>hermes</code>. We also discussed the class design with Valerie
Obenchain, and discussed <code>RNAseq</code> data standards with Armen
Karapetyan. We borrowed some ideas from the Roche internal
<code>biokitr</code> R package and discussed them with its maintainer
Daniel Marbach.</p>
<p>Finally, <code>hermes</code> originated as part of the NEST project.
We are grateful for the entire team’s support.</p>
<p>Thanks a lot to everyone involved!</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>First let’s see how we can install the <code>hermes</code>
package.</p>
<div class="section level3">
<h3 id="bioconductor">
<code>BioConductor</code><a class="anchor" aria-label="anchor" href="#bioconductor"></a>
</h3>
<p>With the development version (3.15) of <code>BioConductor</code>, you
can install the current package version with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"hermes"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="github">GitHub<a class="anchor" aria-label="anchor" href="#github"></a>
</h3>
<p>You can install the unstable development version from GitHub
with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"insightsengineering/hermes"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>hermes</code> R package provides classes, methods and
functions to import, quality-check, filter, normalize, analyze
<code>RNAseq</code> counts data. The core functionality is built on the
<code>BioConductor</code> ecosystem, especially
<code>SummarizedExperiment</code>. This is the vignette to read for new
users of this package.</p>
<p>In this vignette you are going to learn how to:</p>
<ul>
<li>Import <code>RNAseq</code> count data into the <code>hermes</code>
ready format.</li>
<li>Annotate gene information automatically from a central database
(e.g. <code>BioMart</code>).</li>
<li>Add quality control (QC) flags to genes and samples.</li>
<li>Filter the data set.</li>
<li>Normalize the counts.</li>
<li>Quickly produce descriptive plots.</li>
<li>Perform principal components analysis.</li>
<li>Produce a templated QC report.</li>
<li>Perform differential expression analysis.</li>
</ul>
<p>The packages used in this vignette are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/hermes/" class="external-link">hermes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></code></pre></div>
<p>The datasets used in this vignette are:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">expression_set</span></span>
<span><span class="op">?</span><span class="va">summarized_experiment</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-data">Importing Data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>The data for <code>hermes</code> needs to be imported into the
<code>HermesData</code> or <code>RangedHermesData</code> format.</p>
<div class="section level3">
<h3 id="importing-a-summarizedexperiment">Importing a <code>SummarizedExperiment</code><a class="anchor" aria-label="anchor" href="#importing-a-summarizedexperiment"></a>
</h3>
<p>The simplest way to import data is from a
<code>SummarizedExperiment</code> (SE) object. This is because a
<code>HermesData</code> object is just a special SE, with few additional
requirements and slots.</p>
<p>In a nutshell, the object needs to have a <code>counts</code> assay,
have certain gene and sample variables, and have unique row and column
names. The row names, i.e. the gene names, must start with a common
prefix <code>GeneID</code> or <code>ENSG</code> to enable easy
annotations. See <code><a href="../reference/HermesData-class.html">?HermesData</a></code> for the detailed
requirements.</p>
<p>When the SE follows the minimum conventions, we can just call the
<code>HermesData</code> constructor on it:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HermesData-class.html">HermesData</a></span><span class="op">(</span><span class="va">summarized_experiment</span><span class="op">)</span></span></code></pre></div>
<p>And we have a <code>HermesData</code> object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span></span>
<span><span class="co">#&gt; class: HermesData</span></span>
<span><span class="co">#&gt; assays(1): counts</span></span>
<span><span class="co">#&gt; genes(5085): GeneID:11185 GeneID:10677 ... GeneID:9087 GeneID:9426</span></span>
<span><span class="co">#&gt; additional gene information(12): HGNC HGNCGeneName ... chromosome_name</span></span>
<span><span class="co">#&gt;   LowExpressionFlag</span></span>
<span><span class="co">#&gt; samples(20): 06520011B0023R 06520067C0018R ... 06520015C0016R</span></span>
<span><span class="co">#&gt;   06520019C0023R</span></span>
<span><span class="co">#&gt; additional sample information(74): Filename SampleID ... LowDepthFlag</span></span>
<span><span class="co">#&gt;   TechnicalFailureFlag</span></span></code></pre></div>
<p>Note that in this case deprecated names were used for the
<code>rowData</code> and <code>colData</code> variables, therefore they
appear under “additional” gene and sample information. However we can
still call the default constructor because the new names will be filled
with missing values, e.g.:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/annotation.html">annotation</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 4 columns</span></span>
<span><span class="co">#&gt;                     symbol      desc chromosome      size</span></span>
<span><span class="co">#&gt;                  &lt;logical&gt; &lt;logical&gt;  &lt;logical&gt; &lt;logical&gt;</span></span>
<span><span class="co">#&gt; GeneID:11185            NA        NA         NA        NA</span></span>
<span><span class="co">#&gt; GeneID:10677            NA        NA         NA        NA</span></span>
<span><span class="co">#&gt; GeneID:101928428        NA        NA         NA        NA</span></span>
<span><span class="co">#&gt; GeneID:100422835        NA        NA         NA        NA</span></span>
<span><span class="co">#&gt; GeneID:102466731        NA        NA         NA        NA</span></span>
<span><span class="co">#&gt; GeneID:64881            NA        NA         NA        NA</span></span></code></pre></div>
<p>If we want to map old column names to new column names to avoid
duplication with new missing value columns, we can do this using the
<code><a href="../reference/rename.html">rename()</a></code> method. For example here:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">summarized_experiment</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    row_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      symbol <span class="op">=</span> <span class="st">"HGNC"</span>,</span>
<span>      desc <span class="op">=</span> <span class="st">"HGNCGeneName"</span>,</span>
<span>      chromosome <span class="op">=</span> <span class="st">"Chromosome"</span>,</span>
<span>      size <span class="op">=</span> <span class="st">"WidthBP"</span>,</span>
<span>      low_expression_flag <span class="op">=</span> <span class="st">"LowExpressionFlag"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    col_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      low_depth_flag <span class="op">=</span> <span class="st">"LowDepthFlag"</span>,</span>
<span>      technical_failure_flag <span class="op">=</span> <span class="st">"TechnicalFailureFlag"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/HermesData-class.html">HermesData</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For example we can now see in the annotations that we successfully
carried over the information since we mapped the old annotations to the
new required names above:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/annotation.html">annotation</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 4 columns</span></span>
<span><span class="co">#&gt;                        symbol                   desc  chromosome      size</span></span>
<span><span class="co">#&gt;                   &lt;character&gt;            &lt;character&gt; &lt;character&gt; &lt;integer&gt;</span></span>
<span><span class="co">#&gt; GeneID:11185             INMT indolethylamine N-me..           7      5468</span></span>
<span><span class="co">#&gt; GeneID:10677             AVIL               advillin          12     18694</span></span>
<span><span class="co">#&gt; GeneID:101928428 LOC101928428 RNA-binding protein ..  GL000220.1       138</span></span>
<span><span class="co">#&gt; GeneID:100422835      MIR3183          microRNA 3183          17        84</span></span>
<span><span class="co">#&gt; GeneID:102466731     MIR6769A         microRNA 6769a          16        73</span></span>
<span><span class="co">#&gt; GeneID:64881           PCDH20       protocadherin 20          13      5838</span></span></code></pre></div>
<p>For a bit more details we can also call <code><a href="../reference/summary.html">summary()</a></code> on the
object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; HermesData object with 20 samples of 5085 genes.</span></span>
<span><span class="co">#&gt; - Library sizes across samples: mean 5476759, median 5365970, range 4632496 to 7262374</span></span>
<span><span class="co">#&gt; - Included assays (1): counts</span></span>
<span><span class="co">#&gt; - Additional gene information (7): GeneID StartBP ... SYMBOL</span></span>
<span><span class="co">#&gt;   chromosome_name</span></span>
<span><span class="co">#&gt; - Additional sample information (73): Filename SampleID ... STDSSDY</span></span>
<span><span class="co">#&gt;   technical_failure_flag</span></span>
<span><span class="co">#&gt; - Low expression genes (3021): GeneID:10677 GeneID:101928428 ...</span></span>
<span><span class="co">#&gt;   GeneID:9084 GeneID:9426</span></span>
<span><span class="co">#&gt; - Samples with too low depth or technical failures (20): NA NA ... NA</span></span>
<span><span class="co">#&gt;   NA</span></span></code></pre></div>
<p>For the below, let’s use the already prepared <code>HermesData</code>
object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">hermes_data</span></span></code></pre></div>
<p>Likewise, when we receive the error “no ‘counts’ assay found”, we can
use the <code><a href="../reference/rename.html">rename()</a></code> function to change the name of the assay
in the <code>SummarizedExperiment</code> object to <code>counts</code>.
For example, the following object of type
<code>SummarizedExperiment</code> would have the assay name
<code>count</code>, and would produce the assay name error:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_exp</span> <span class="op">&lt;-</span> <span class="va">summarized_experiment</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rename.html">rename</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>count <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And we would use the following code to convert the assay name to
<code>counts</code>, making it able to convert into
<code>HermesData</code> object:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename.html">rename</a></span><span class="op">(</span><span class="va">object_exp</span>,</span>
<span>  assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HermesData-class.html">HermesData</a></span><span class="op">(</span><span class="va">object_exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-an-expressionset">Importing an <code>ExpressionSet</code><a class="anchor" aria-label="anchor" href="#importing-an-expressionset"></a>
</h3>
<p>If we start from an <code>ExpressionSet</code>, we can first convert
it to a <code>RangedSummarizedExperiment</code> and then import it to
<code>RangedHermesData</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/makeSummarizedExperimentFromExpressionSet.html" class="external-link">makeSummarizedExperimentFromExpressionSet</a></span><span class="op">(</span><span class="va">expression_set</span><span class="op">)</span></span>
<span><span class="va">object2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HermesData-class.html">HermesData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="va">object2</span></span>
<span><span class="co">#&gt; class: RangedHermesData</span></span>
<span><span class="co">#&gt; assays(1): counts</span></span>
<span><span class="co">#&gt; genes(5085): GeneID:11185 GeneID:10677 ... GeneID:9087 GeneID:9426</span></span>
<span><span class="co">#&gt; additional gene information(12): HGNC HGNCGeneName ... chromosome_name</span></span>
<span><span class="co">#&gt;   LowExpressionFlag</span></span>
<span><span class="co">#&gt; samples(20): 06520011B0023R 06520067C0018R ... 06520015C0016R</span></span>
<span><span class="co">#&gt;   06520019C0023R</span></span>
<span><span class="co">#&gt; additional sample information(74): Filename SampleID ... LowDepthFlag</span></span>
<span><span class="co">#&gt;   TechnicalFailureFlag</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-a-matrix">Importing a Matrix<a class="anchor" aria-label="anchor" href="#importing-a-matrix"></a>
</h3>
<p>In general we can also import a matrix of counts. We just have to
pass the required gene and sample information as data frames to the
constructor.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">hermes_data</span><span class="op">)</span></span>
<span><span class="va">object3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HermesData-class.html">HermesDataFromMatrix</a></span><span class="op">(</span></span>
<span>  counts <span class="op">=</span> <span class="va">counts_matrix</span>,</span>
<span>  rowData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">hermes_data</span><span class="op">)</span>,</span>
<span>  colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">hermes_data</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object3</span></span>
<span><span class="co">#&gt; class: HermesData</span></span>
<span><span class="co">#&gt; assays(1): counts</span></span>
<span><span class="co">#&gt; genes(5085): GeneID:11185 GeneID:10677 ... GeneID:9087 GeneID:9426</span></span>
<span><span class="co">#&gt; additional gene information(3): GeneID SYMBOL chromosome_name</span></span>
<span><span class="co">#&gt; samples(20): 06520011B0023R 06520067C0018R ... 06520015C0016R</span></span>
<span><span class="co">#&gt;   06520019C0023R</span></span>
<span><span class="co">#&gt; additional sample information(72): Filename SampleID ... TTYPE STDSSDY</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">object3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Note that we can easily access the counts assay (matrix) in the final
object with <code><a href="../reference/counts.html">counts()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts.html">counts</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="va">cnts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;                  06520011B0023R 06520067C0018R 06520063C0043R</span></span>
<span><span class="co">#&gt; GeneID:11185                  3             66             35</span></span>
<span><span class="co">#&gt; GeneID:10677               1668            236             95</span></span>
<span><span class="co">#&gt; GeneID:101928428              0              0              0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="annotations">Annotations<a class="anchor" aria-label="anchor" href="#annotations"></a>
</h2>
<p><code>hermes</code> provides a modular approach for querying gene
annotations, in order to allow for future extensions in this or other
downstream packages.</p>
<div class="section level3">
<h3 id="connection-to-database">Connection to Database<a class="anchor" aria-label="anchor" href="#connection-to-database"></a>
</h3>
<p>The first step is to connect to a database. In <code>hermes</code>
the only option is currently databases that utilize the
<code>BioMart</code> software suite. However due to the generic function
design, it is simple to extend <code>hermes</code> with other data base
connections.</p>
<p>In order to save time during vignette build, we zoom in here on a
subset of the original <code>object</code> containing only the first 10
genes.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">small_object</span> <span class="op">&lt;-</span> <span class="va">object</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></code></pre></div>
<p>The corresponding function takes the common gene ID prefix as
argument to determine the format of the gene IDs and the filter variable
to use in the query later on.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/set_config.html" class="external-link">set_config</a></span><span class="op">(</span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></span><span class="op">(</span>ssl_verifypeer <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">connection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_biomart.html">connect_biomart</a></span><span class="op">(</span><span class="fu"><a href="../reference/prefix.html">prefix</a></span><span class="op">(</span><span class="va">small_object</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here we are using the <code><a href="../reference/prefix.html">prefix()</a></code> method to access the
prefix saved in the <code>HermesData</code> object.</p>
</div>
<div class="section level3">
<h3 id="querying-and-saving-annotations">Querying and Saving Annotations<a class="anchor" aria-label="anchor" href="#querying-and-saving-annotations"></a>
</h3>
<p>Then the second step is to query the gene annotations and save them
in the object.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/annotation.html">annotation</a></span><span class="op">(</span><span class="va">small_object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query.html">query</a></span><span class="op">(</span><span class="fu"><a href="../reference/genes.html">genes</a></span><span class="op">(</span><span class="va">small_object</span><span class="op">)</span>, <span class="va">connection</span><span class="op">)</span></span></code></pre></div>
<p>Here we are using the <code><a href="../reference/genes.html">genes()</a></code> method to access the gene
IDs (row names) of the <code>HermesData</code> object. Note that not all
genes might be found in the data base and the corresponding rows would
then be <code>NA</code> in the annotations.</p>
</div>
</div>
<div class="section level2">
<h2 id="quality-control-flags">Quality Control Flags<a class="anchor" aria-label="anchor" href="#quality-control-flags"></a>
</h2>
<p><code>hermes</code> provides automatic gene and sample flagging, as
well as manual sample flagging functionality.</p>
<div class="section level3">
<h3 id="automatic-gene-and-sample-flagging">Automatic Gene and Sample Flagging<a class="anchor" aria-label="anchor" href="#automatic-gene-and-sample-flagging"></a>
</h3>
<p>For genes, it is counted how many samples don’t pass a minimum
expression <code>CPM</code> (counts per million reads mapped) threshold.
If too many, then this gene is flagged as a “low expression” gene.</p>
<p>For samples, two flags are provided. The “technical failure” flag is
based on the average Pearson correlation with other samples. The “low
depth” flag is based on the library size, i.e. the total sum of counts
for a sample across all genes.</p>
<p>Thresholds for the above flags can be initialized with
<code><a href="../reference/control_quality.html">control_quality()</a></code>, and the flags are added with
<code><a href="../reference/quality_flags.html">add_quality_flags()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_controls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/control_quality.html">control_quality</a></span><span class="op">(</span>min_cpm <span class="op">=</span> <span class="fl">10</span>, min_cpm_prop <span class="op">=</span> <span class="fl">0.4</span>, min_corr <span class="op">=</span> <span class="fl">0.4</span>, min_depth <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: testthat</span></span>
<span><span class="va">object_flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quality_flags.html">add_quality_flags</a></span><span class="op">(</span><span class="va">object</span>, control <span class="op">=</span> <span class="va">my_controls</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="manual-sample-flagging">Manual Sample Flagging<a class="anchor" aria-label="anchor" href="#manual-sample-flagging"></a>
</h3>
<p>Sometimes it is necessary to manually flag certain samples as
technical failures, e.g. after looking at one of the analyses discussed
below. This is possible, too.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_tech_failure.html">set_tech_failure</a></span><span class="op">(</span><span class="va">object_flagged</span>, sample_ids <span class="op">=</span> <span class="st">"06520011B0023R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="accessing-flags">Accessing Flags<a class="anchor" aria-label="anchor" href="#accessing-flags"></a>
</h3>
<p>All flags have access functions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/quality_flags.html">get_tech_failure</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 06520011B0023R 06520067C0018R 06520063C0043R 06520105C0017R 06520092C0017R </span></span>
<span><span class="co">#&gt;           TRUE          FALSE          FALSE          FALSE          FALSE </span></span>
<span><span class="co">#&gt; 06520103C0017R </span></span>
<span><span class="co">#&gt;          FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/quality_flags.html">get_low_depth</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 06520011B0023R 06520067C0018R 06520063C0043R 06520105C0017R 06520092C0017R </span></span>
<span><span class="co">#&gt;          FALSE          FALSE          FALSE          FALSE          FALSE </span></span>
<span><span class="co">#&gt; 06520103C0017R </span></span>
<span><span class="co">#&gt;          FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/quality_flags.html">get_low_expression</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     GeneID:11185     GeneID:10677 GeneID:101928428 GeneID:100422835 </span></span>
<span><span class="co">#&gt;             TRUE            FALSE             TRUE             TRUE </span></span>
<span><span class="co">#&gt; GeneID:102466731     GeneID:64881 </span></span>
<span><span class="co">#&gt;             TRUE             TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="filtering-data">Filtering Data<a class="anchor" aria-label="anchor" href="#filtering-data"></a>
</h2>
<p>We can either filter based on the default QC flags, or based on
custom variables from the gene or sample information.</p>
<div class="section level3">
<h3 id="based-on-default-qc-flags">Based on Default QC Flags<a class="anchor" aria-label="anchor" href="#based-on-default-qc-flags"></a>
</h3>
<p>This is simple with the <code><a href="../reference/filter.html">filter()</a></code> function. It is also
possible to selectively only filter the genes or the samples using the
<code>what</code> argument.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_flagged_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span></span>
<span><span class="va">object_flagged_genes_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="va">object_flagged</span>, what <span class="op">=</span> <span class="st">"genes"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="based-on-custom-variables">Based on Custom Variables<a class="anchor" aria-label="anchor" href="#based-on-custom-variables"></a>
</h3>
<p>This can be done with the <code><a href="../reference/subset.html">subset()</a></code> function. Genes can
be filtered with the <code>subset</code> argument via expressions using
the gene information variables, and samples can be filtered with the
<code>select</code> argument using the sample information variables. In
order to see which ones are available these can be queries first.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "symbol"              "desc"                "GeneID"             </span></span>
<span><span class="co">#&gt; [4] "chromosome"          "size"                "SYMBOL"             </span></span>
<span><span class="co">#&gt; [7] "chromosome_name"     "low_expression_flag"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Filename"          "SampleID"          "AGEGRP"           </span></span>
<span><span class="co">#&gt;  [4] "AGE18"             "STDDRS"            "STDDRSD"          </span></span>
<span><span class="co">#&gt;  [7] "STDSSDT"           "TRTDRS"            "TRTDRSD"          </span></span>
<span><span class="co">#&gt; [10] "BHDCIRC"           "BHDCIRCU"          "ADAFL"            </span></span>
<span><span class="co">#&gt; [13] "BLANP"             "BKPS"              "BLKS"             </span></span>
<span><span class="co">#&gt; [16] "BTANNER"           "FRPST"             "DURIDX"           </span></span>
<span><span class="co">#&gt; [19] "DURSAF"            "DURSUR"            "LNTHRPY"          </span></span>
<span><span class="co">#&gt; [22] "AENCIFL"           "STUDYID"           "USUBJID"          </span></span>
<span><span class="co">#&gt; [25] "RFSTDTC"           "RFENDTC"           "RFXSTDTC"         </span></span>
<span><span class="co">#&gt; [28] "RFXENDTC"          "RFICDTC"           "RFPENDTC"         </span></span>
<span><span class="co">#&gt; [31] "DTHDTC"            "DTHFL"             "SITEID"           </span></span>
<span><span class="co">#&gt; [34] "INVID"             "AGE"               "AGEU"             </span></span>
<span><span class="co">#&gt; [37] "SEX"               "RACE"              "ETHNIC"           </span></span>
<span><span class="co">#&gt; [40] "ARMCD"             "ARM"               "ACTARMCD"         </span></span>
<span><span class="co">#&gt; [43] "ACTARM"            "COUNTRY"           "DMDTC"            </span></span>
<span><span class="co">#&gt; [46] "DMDY"              "BAGE"              "BAGEU"            </span></span>
<span><span class="co">#&gt; [49] "BWT"               "BWTU"              "BHT"              </span></span>
<span><span class="co">#&gt; [52] "BHTU"              "BBMI"              "ITTFL"            </span></span>
<span><span class="co">#&gt; [55] "SAFFL"             "INFCODT"           "RANDDT"           </span></span>
<span><span class="co">#&gt; [58] "TRTSDTC"           "TRTSDTM"           "TRTSTMF"          </span></span>
<span><span class="co">#&gt; [61] "TRTEDTM"           "TRTETMF"           "TRTDUR"           </span></span>
<span><span class="co">#&gt; [64] "DISCSTUD"          "DISCDEAT"          "DISCAE"           </span></span>
<span><span class="co">#&gt; [67] "DISTRTFL"          "AEWITHFL"          "ALIVDT"           </span></span>
<span><span class="co">#&gt; [70] "COHORT"            "TTYPE"             "STDSSDY"          </span></span>
<span><span class="co">#&gt; [73] "low_depth_flag"    "tech_failure_flag"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">)</span><span class="op">$</span><span class="va">chromosome</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "7"          "12"         "GL000220.1" "17"         "16"        </span></span>
<span><span class="co">#&gt; [6] "13"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">object_flagged</span><span class="op">$</span><span class="va">ARMCD</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "COH1"  "COH1"  "COH8"  "COH12" "COH9O" "COH9E"</span></span>
<span><span class="va">object_flagged_subsetted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset.html">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">object_flagged</span>,</span>
<span>  subset <span class="op">=</span> <span class="va">chromosome</span> <span class="op">==</span> <span class="st">"5"</span>,</span>
<span>  select <span class="op">=</span> <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"COH1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="normalizing-counts">Normalizing Counts<a class="anchor" aria-label="anchor" href="#normalizing-counts"></a>
</h2>
<p>Normalizing counts within samples (<code>CPM</code>), genes (RPKM) or
across both (TPM) can be achieved with the <code><a href="../reference/normalize.html">normalize()</a></code>
function. The <code><a href="../reference/normalize.html">normalize()</a></code> function can also transform the
counts by the variance stabilizing transformation (<code>vst</code>) and
the regularized log transformation (<code>rlog</code>) as proposed in
the <code>DESeq2</code> package.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_normalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span><span class="va">object_flagged_filtered</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- note: fitType='parametric', but the dispersion trend was not well captured by the</span></span>
<span><span class="co">#&gt;    function: y = a/x + b, and a local regression fit was automatically substituted.</span></span>
<span><span class="co">#&gt;    specify fitType='local' or 'mean' to avoid this message next time.</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_rlog_normalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span><span class="va">object_flagged_filtered</span>, <span class="st">"rlog"</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- note: fitType='parametric', but the dispersion trend was not well captured by the</span></span>
<span><span class="co">#&gt;    function: y = a/x + b, and a local regression fit was automatically substituted.</span></span>
<span><span class="co">#&gt;    specify fitType='local' or 'mean' to avoid this message next time.</span></span></code></pre></div>
<p>The corresponding assays are saved in the object and can be accessed
with <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">object_normalized</span>, <span class="st">"tpm"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;               06520067C0018R 06520063C0043R 06520105C0017R</span></span>
<span><span class="co">#&gt; GeneID:10677        4.096418       3.323016       7.714990</span></span>
<span><span class="co">#&gt; GeneID:286205       2.985506       3.182624       3.769962</span></span>
<span><span class="co">#&gt; GeneID:8365        11.711741      12.421108      12.466491</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">object_rlog_normalized</span>, <span class="st">"rlog"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;               06520067C0018R 06520063C0043R 06520105C0017R</span></span>
<span><span class="co">#&gt; GeneID:10677        8.101651       7.153488      10.281393</span></span>
<span><span class="co">#&gt; GeneID:286205      10.101287       9.859074      10.104426</span></span>
<span><span class="co">#&gt; GeneID:8365        10.023097      10.163191       9.935722</span></span></code></pre></div>
<p>The used control settings can be accessed afterwards from the
metadata of the object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/metadata.html">metadata</a></span><span class="op">(</span><span class="va">object_normalized</span><span class="op">)</span></span>
<span><span class="co">#&gt; $control_quality_flags</span></span>
<span><span class="co">#&gt; $control_quality_flags$min_cpm</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_quality_flags$min_cpm_prop</span></span>
<span><span class="co">#&gt; [1] 0.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_quality_flags$min_corr</span></span>
<span><span class="co">#&gt; [1] 0.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_quality_flags$min_depth</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_normalize</span></span>
<span><span class="co">#&gt; $control_normalize$log</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_normalize$lib_sizes</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_normalize$prior_count</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $control_normalize$fit_type</span></span>
<span><span class="co">#&gt; [1] "parametric"</span></span></code></pre></div>
<p>Note that also the filtering settings are saved in here. For custom
normalization options, use <code><a href="../reference/control_normalize.html">control_normalize()</a></code>. For
example, to not use log scale but the original scale of the counts:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_normalized_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span></span>
<span>  <span class="va">object_flagged_filtered</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../reference/control_normalize.html">control_normalize</a></span><span class="op">(</span>log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; -- note: fitType='parametric', but the dispersion trend was not well captured by the</span></span>
<span><span class="co">#&gt;    function: y = a/x + b, and a local regression fit was automatically substituted.</span></span>
<span><span class="co">#&gt;    specify fitType='local' or 'mean' to avoid this message next time.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">object_normalized_original</span>, <span class="st">"tpm"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;               06520067C0018R 06520063C0043R 06520105C0017R</span></span>
<span><span class="co">#&gt; GeneID:10677       16.105854       9.007544       209.1084</span></span>
<span><span class="co">#&gt; GeneID:286205       6.920033       8.079569        12.6418</span></span>
<span><span class="co">#&gt; GeneID:8365      3353.172671    5483.360511      5658.6256</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="descriptive-plots">Descriptive Plots<a class="anchor" aria-label="anchor" href="#descriptive-plots"></a>
</h2>
<div class="section level3">
<h3 id="simple-plots">Simple Plots<a class="anchor" aria-label="anchor" href="#simple-plots"></a>
</h3>
<p>A series of simple descriptive plots can be obtained by just calling
<code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> on an object.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-30-1.png" width="700"><img src="hermes_files/figure-html/unnamed-chunk-30-2.png" width="700"><img src="hermes_files/figure-html/unnamed-chunk-30-3.png" width="700"><img src="hermes_files/figure-html/unnamed-chunk-30-4.png" width="700"><img src="hermes_files/figure-html/unnamed-chunk-30-5.png" width="700"></p>
<p>Note that individual plots from these can be produced with the series
of <code>draw_*()</code> functions, see <code><a href="../reference/plot_all.html">?plot_all</a></code> for the
detailed list. Then, these can be customized further. For example, we
can change the number and color of the bins in the library size
histogram:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_libsize_hist.html">draw_libsize_hist</a></span><span class="op">(</span><span class="va">object</span>, bins <span class="op">=</span> <span class="fl">10L</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="top-genes">Top Genes<a class="anchor" aria-label="anchor" href="#top-genes"></a>
</h3>
<p>Top genes can be calculated and visualized in a barplot.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">most_expr_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/top_genes.html">top_genes</a></span><span class="op">(</span><span class="va">object_normalized</span>, assay_name <span class="op">=</span> <span class="st">"tpm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">most_expr_genes</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>By passing another summary function, also the variability can be
ranked for example.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">most_var_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/top_genes.html">top_genes</a></span><span class="op">(</span><span class="va">object_normalized</span>, summary_fun <span class="op">=</span> <span class="va">rowSds</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">most_var_genes</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="heatmap-of-genes-among-samples">Heatmap of Genes among Samples<a class="anchor" aria-label="anchor" href="#heatmap-of-genes-among-samples"></a>
</h3>
<p>Relative expression of genes can be displayed using a heatmap</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_heatmap.html">draw_heatmap</a></span><span class="op">(</span><span class="va">object</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, assay_name <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>The heatmap can be grouped by labels in the <code>HermesData</code>
object, such as <code>"COUNTRY"</code> or <code>"AGEGRP"</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_heatmap.html">draw_heatmap</a></span><span class="op">(</span><span class="va">object</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, assay_name <span class="op">=</span> <span class="st">"counts"</span>, col_data_annotation <span class="op">=</span> <span class="st">"COUNTRY"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="correlation-between-samples">Correlation between Samples<a class="anchor" aria-label="anchor" href="#correlation-between-samples"></a>
</h3>
<p>A sample correlation matrix between samples can be obtained with the
<code><a href="../reference/correlate.html">correlate()</a></code> function. This can be visualized in a heatmap
using <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> again. See <code><a href="../reference/calc_cor.html">?calc_cor</a></code> for
detailed options.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlate.html">correlate</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">cor_mat</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="principal-components">Principal Components<a class="anchor" aria-label="anchor" href="#principal-components"></a>
</h2>
<p>Let’s see how we can perform Principal Components Analysis (PCA).</p>
<div class="section level3">
<h3 id="pca-of-samples">PCA of Samples<a class="anchor" aria-label="anchor" href="#pca-of-samples"></a>
</h3>
<p>PCA can be performed with <code><a href="../reference/calc_pca.html">calc_pca()</a></code>. The result can be
summarized or plotted.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_pca.html">calc_pca</a></span><span class="op">(</span><span class="va">object_normalized</span>, assay_name <span class="op">=</span> <span class="st">"tpm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">pca_res</span><span class="op">)</span><span class="op">$</span><span class="va">importance</span></span>
<span><span class="co">#&gt;                             PC1      PC2      PC3      PC4      PC5      PC6</span></span>
<span><span class="co">#&gt; Standard deviation     22.08095 17.34762 15.19930 12.80689 11.76153 10.48121</span></span>
<span><span class="co">#&gt; Proportion of Variance  0.24066  0.14854  0.11403  0.08096  0.06828  0.05422</span></span>
<span><span class="co">#&gt; Cumulative Proportion   0.24066  0.38919  0.50322  0.58418  0.65246  0.70668</span></span>
<span><span class="co">#&gt;                             PC7      PC8      PC9     PC10     PC11     PC12</span></span>
<span><span class="co">#&gt; Standard deviation     9.812505 8.950926 8.530826 8.196006 7.905973 7.216002</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.047520 0.039550 0.035920 0.033160 0.030850 0.025700</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.754200 0.793750 0.829670 0.862830 0.893680 0.919380</span></span>
<span><span class="co">#&gt;                           PC13     PC14     PC15     PC16     PC17             </span></span>
<span><span class="co">#&gt; Standard deviation     6.92755 6.532485 5.501383 5.151959 3.983283 2.302918e-14</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.02369 0.021060 0.014940 0.013100 0.007830 0.000000e+00</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.94307 0.964130 0.979070 0.992170 1.000000 1.000000e+00</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">pca_res</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>Note that various options are available for the plot, for example we
can look at different principal components, and color the samples by
sample variables. See <code><a href="https://rdrr.io/pkg/ggfortify/man/autoplot.pca_common.html" class="external-link">?ggfortify::autoplot.prcomp</a></code> for
details.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">pca_res</span>,</span>
<span>  x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">object_normalized</span><span class="op">)</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"SEX"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="correlation-with-sample-variables">Correlation with Sample Variables<a class="anchor" aria-label="anchor" href="#correlation-with-sample-variables"></a>
</h3>
<p>Subsequently it is easy to correlate the obtained principal
components with the sample variables. We obtain a matrix of R-squared
(R2) values for all combinations, which can again be visualized as a
heatmap. See <code><a href="../reference/pca_cor_samplevar.html">?pca_cor_samplevar</a></code> for details.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlate.html">correlate</a></span><span class="op">(</span><span class="va">pca_res</span>, <span class="va">object_normalized</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">pca_cor</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="qc-report-template">QC Report Template<a class="anchor" aria-label="anchor" href="#qc-report-template"></a>
</h2>
<p>In order to quickly obtain a quality control report for a new
<code>RNAseq</code> data set, you can proceed as follows.</p>
<ol style="list-style-type: decimal">
<li>Save your input <code>SummarizedExperiment</code> using R’s
<code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code> function in a binary data file (e.g. ending with
<code>.rda</code> suffix).</li>
<li>Load the <code>hermes</code> package in <code>RStudio</code> and
click on: <code>File</code> &gt; <code>New File</code> &gt;
<code>R Markdown</code> &gt; <code>From Template</code> and select the
QC report template from <code>hermes</code>. <img src="rmd_template_selection.png" style="width:4in" alt="Rmd_template_selection">
</li>
<li>Fill in the few parameters in the <code>yaml</code> header,
including the required file paths for the input file from above, and
where the resulting <code>HermesData</code> object should be saved.</li>
<li>Knit the document.</li>
</ol>
<p>The report contains the above mentioned descriptive plots and PCA
analyses and can be a useful starting point for your analysis.</p>
</div>
<div class="section level2">
<h2 id="differential-expression">Differential Expression<a class="anchor" aria-label="anchor" href="#differential-expression"></a>
</h2>
<p>In addition to the above QC analyses, simple differential expression
analysis is supported by <code>hermes</code>. In addition to the
filtered object (normalization of counts is not required) the variable
name of the factor to contrast the samples needs to be provided to
<code><a href="../reference/diff_expression.html">diff_expression()</a></code>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df_cols_to_factor.html">df_cols_to_factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">diff_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diff_expression.html">diff_expression</a></span><span class="op">(</span><span class="va">object</span>, group <span class="op">=</span> <span class="st">"SEX"</span>, method <span class="op">=</span> <span class="st">"voom"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diff_res</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  log2_fc      stat        p_val adj_p_val</span></span>
<span><span class="co">#&gt; GeneID:8000   -2.3200712 -4.239244 0.0004209192 0.9118348</span></span>
<span><span class="co">#&gt; GeneID:51227  -1.0467295 -4.032550 0.0006788432 0.9118348</span></span>
<span><span class="co">#&gt; GeneID:344558  1.6896266  3.824046 0.0010993677 0.9118348</span></span>
<span><span class="co">#&gt; GeneID:51575  -0.7760844 -3.746293 0.0013155805 0.9118348</span></span>
<span><span class="co">#&gt; GeneID:151242 -3.4358998 -3.570103 0.0019741997 0.9118348</span></span>
<span><span class="co">#&gt; GeneID:8904   -0.6100354 -3.542864 0.0021017199 0.9118348</span></span></code></pre></div>
<p>Note that we use here the utility function
<code><a href="../reference/df_cols_to_factor.html">df_cols_to_factor()</a></code> which converts by default all character
and logical variables to factor variables. This is one possible way here
to ensure that the utilized group variable is a factor.</p>
<p>Afterwards a standard volcano plot can be produced.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">diff_res</span>, log2_fc_thresh <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="hermes_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The <code>hermes</code> R package provides classes, methods and
functions to import, quality-check, filter, normalize and analyze
<code>RNAseq</code> counts data. In particular, the robust
object-oriented framework allows for easy extensions in the future to
address user feature requests. These and other feedback are very welcome
- thank you very much in advance for your thoughts on
<code>hermes</code>!</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>Here is the output of <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> on the system on
which this document was compiled running <code>pandoc</code> 3.1.1:</p>
<pre><code><span><span class="co">#&gt; R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] hermes_1.0.1.9014           SummarizedExperiment_1.30.2</span></span>
<span><span class="co">#&gt;  [3] Biobase_2.60.0              GenomicRanges_1.52.0       </span></span>
<span><span class="co">#&gt;  [5] GenomeInfoDb_1.36.0         IRanges_2.34.0             </span></span>
<span><span class="co">#&gt;  [7] S4Vectors_0.38.1            BiocGenerics_0.46.0        </span></span>
<span><span class="co">#&gt;  [9] MatrixGenerics_1.12.2       matrixStats_1.0.0          </span></span>
<span><span class="co">#&gt; [11] ggfortify_0.4.16            ggplot2_3.4.2              </span></span>
<span><span class="co">#&gt; [13] BiocStyle_2.28.0           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] Rdpack_2.4                  DBI_1.1.3                  </span></span>
<span><span class="co">#&gt;   [3] bitops_1.0-7                gridExtra_2.3              </span></span>
<span><span class="co">#&gt;   [5] testthat_3.1.9              biomaRt_2.56.1             </span></span>
<span><span class="co">#&gt;   [7] rlang_1.1.1                 magrittr_2.0.3             </span></span>
<span><span class="co">#&gt;   [9] clue_0.3-64                 GetoptLong_1.0.5           </span></span>
<span><span class="co">#&gt;  [11] compiler_4.3.1              RSQLite_2.3.1              </span></span>
<span><span class="co">#&gt;  [13] png_0.1-8                   systemfonts_1.0.4          </span></span>
<span><span class="co">#&gt;  [15] vctrs_0.6.3                 stringr_1.5.0              </span></span>
<span><span class="co">#&gt;  [17] pkgconfig_2.0.3             shape_1.4.6                </span></span>
<span><span class="co">#&gt;  [19] crayon_1.5.2                fastmap_1.1.1              </span></span>
<span><span class="co">#&gt;  [21] magick_2.7.4                dbplyr_2.3.2               </span></span>
<span><span class="co">#&gt;  [23] backports_1.4.1             XVector_0.40.0             </span></span>
<span><span class="co">#&gt;  [25] labeling_0.4.2              utf8_1.2.3                 </span></span>
<span><span class="co">#&gt;  [27] rmarkdown_2.22              ragg_1.2.5                 </span></span>
<span><span class="co">#&gt;  [29] purrr_1.0.1                 bit_4.0.5                  </span></span>
<span><span class="co">#&gt;  [31] xfun_0.39                   MultiAssayExperiment_1.26.0</span></span>
<span><span class="co">#&gt;  [33] zlibbioc_1.46.0             cachem_1.0.8               </span></span>
<span><span class="co">#&gt;  [35] jsonlite_1.8.5              progress_1.2.2             </span></span>
<span><span class="co">#&gt;  [37] EnvStats_2.7.0              blob_1.2.4                 </span></span>
<span><span class="co">#&gt;  [39] highr_0.10                  DelayedArray_0.26.3        </span></span>
<span><span class="co">#&gt;  [41] BiocParallel_1.34.2         prettyunits_1.1.1          </span></span>
<span><span class="co">#&gt;  [43] parallel_4.3.1              cluster_2.1.4              </span></span>
<span><span class="co">#&gt;  [45] R6_2.5.1                    bslib_0.5.0                </span></span>
<span><span class="co">#&gt;  [47] stringi_1.7.12              RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;  [49] limma_3.56.2                brio_1.1.3                 </span></span>
<span><span class="co">#&gt;  [51] jquerylib_0.1.4             Rcpp_1.0.10                </span></span>
<span><span class="co">#&gt;  [53] bookdown_0.34               assertthat_0.2.1           </span></span>
<span><span class="co">#&gt;  [55] iterators_1.0.14            knitr_1.43                 </span></span>
<span><span class="co">#&gt;  [57] Matrix_1.5-4.1              tidyselect_1.2.0           </span></span>
<span><span class="co">#&gt;  [59] yaml_2.3.7                  doParallel_1.0.17          </span></span>
<span><span class="co">#&gt;  [61] codetools_0.2-19            curl_5.0.1                 </span></span>
<span><span class="co">#&gt;  [63] lattice_0.21-8              tibble_3.2.1               </span></span>
<span><span class="co">#&gt;  [65] withr_2.5.0                 KEGGREST_1.40.0            </span></span>
<span><span class="co">#&gt;  [67] evaluate_0.21               desc_1.4.2                 </span></span>
<span><span class="co">#&gt;  [69] BiocFileCache_2.8.0         xml2_1.3.4                 </span></span>
<span><span class="co">#&gt;  [71] Biostrings_2.68.1           circlize_0.4.15            </span></span>
<span><span class="co">#&gt;  [73] filelock_1.0.2              pillar_1.9.0               </span></span>
<span><span class="co">#&gt;  [75] BiocManager_1.30.21         checkmate_2.2.0            </span></span>
<span><span class="co">#&gt;  [77] foreach_1.5.2               generics_0.1.3             </span></span>
<span><span class="co">#&gt;  [79] rprojroot_2.0.3             RCurl_1.98-1.12            </span></span>
<span><span class="co">#&gt;  [81] hms_1.1.3                   munsell_0.5.0              </span></span>
<span><span class="co">#&gt;  [83] scales_1.2.1                glue_1.6.2                 </span></span>
<span><span class="co">#&gt;  [85] tools_4.3.1                 locfit_1.5-9.8             </span></span>
<span><span class="co">#&gt;  [87] forcats_1.0.0               fs_1.6.2                   </span></span>
<span><span class="co">#&gt;  [89] XML_3.99-0.14               grid_4.3.1                 </span></span>
<span><span class="co">#&gt;  [91] tidyr_1.3.0                 rbibutils_2.2.13           </span></span>
<span><span class="co">#&gt;  [93] edgeR_3.42.4                AnnotationDbi_1.62.1       </span></span>
<span><span class="co">#&gt;  [95] colorspace_2.1-0            GenomeInfoDbData_1.2.10    </span></span>
<span><span class="co">#&gt;  [97] cli_3.6.1                   rappdirs_0.3.3             </span></span>
<span><span class="co">#&gt;  [99] textshaping_0.3.6           fansi_1.0.4                </span></span>
<span><span class="co">#&gt; [101] S4Arrays_1.0.4              ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">#&gt; [103] dplyr_1.1.2                 gtable_0.3.3               </span></span>
<span><span class="co">#&gt; [105] DESeq2_1.40.1               sass_0.4.6                 </span></span>
<span><span class="co">#&gt; [107] digest_0.6.31               ggrepel_0.9.3              </span></span>
<span><span class="co">#&gt; [109] farver_2.1.1                rjson_0.2.21               </span></span>
<span><span class="co">#&gt; [111] memoise_2.0.1               htmltools_0.5.5            </span></span>
<span><span class="co">#&gt; [113] pkgdown_2.0.7               lifecycle_1.0.3            </span></span>
<span><span class="co">#&gt; [115] httr_1.4.6                  GlobalOptions_0.1.2        </span></span>
<span><span class="co">#&gt; [117] bit64_4.0.5</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Sabanés Bové, Namrata Bhatia, Stefanie Bienert, Benoit Falquet, Haocheng Li, Jeff Luong, Lyndsee Midori Zhang, Alex Richardson, Simona Rossomanno, Tim Treis, Mark Yan, Naomi Chang, Chendi Liao, Carolyn Zhang, Joseph N. Paulson, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
