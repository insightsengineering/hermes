<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
top_genes() creates a HermesDataTopGenes object, which extends data.frame. It
contains two columns:
expression: containing the statistic values calculated by summary_fun across columns.
name: the gene names.


The corresponding autoplot() method then visualizes the result as a barplot."><title>Derivation of Top Genes — top_genes • hermes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derivation of Top Genes — top_genes"><meta property="og:description" content="
top_genes() creates a HermesDataTopGenes object, which extends data.frame. It
contains two columns:
expression: containing the statistic values calculated by summary_fun across columns.
name: the gene names.


The corresponding autoplot() method then visualizes the result as a barplot."><meta property="og:image" content="https://insightsengineering.github.io/hermes/main/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hermes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.5.9007</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/hermes.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" href="https://insightsengineering.github.io/hermes/main">main</a> </div></li>
<!-- end dropdown for versions -->
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/hermes">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derivation of Top Genes</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/hermes/blob/HEAD/R/top_genes.R" class="external-link"><code>R/top_genes.R</code></a></small>
      <div class="d-none name"><code>top_genes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p><code>top_genes()</code> creates a <code>HermesDataTopGenes</code> object, which extends <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>. It
contains two columns:</p><ul><li><p><code>expression</code>: containing the statistic values calculated by <code>summary_fun</code> across columns.</p></li>
<li><p><code>name</code>: the gene names.</p></li>
</ul><p>The corresponding <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> method then visualizes the result as a barplot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">top_genes</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  summary_fun <span class="op">=</span> <span class="va">rowMeans</span>,</span>
<span>  n_top <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">min_threshold</span><span class="op">)</span><span class="op">)</span> <span class="fl">10L</span> <span class="kw">else</span> <span class="cn">NULL</span>,</span>
<span>  min_threshold <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for HermesDataTopGenes</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"HGNC gene names"</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">summary_fun_name</span>, <span class="st">"("</span>, <span class="va">object</span><span class="op">@</span><span class="va">assay_name</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Top most expressed genes"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>(<code>AnyHermedData</code>)<br> input.</p></dd>


<dt>assay_name</dt>
<dd><p>(<code>string</code>)<br> name of the assay to use for the sorting of genes.</p></dd>


<dt>summary_fun</dt>
<dd><p>(<code>function</code>)<br> summary statistics function to apply across the samples in
the assay resulting in a numeric vector with one value per gene.</p></dd>


<dt>n_top</dt>
<dd><p>(<code>count</code> or <code>NULL</code>)<br> selection criteria based on number of entries.</p></dd>


<dt>min_threshold</dt>
<dd><p>(<code>number</code> or <code>NULL</code> )<br> selection criteria based on a minimum
summary statistics threshold.</p></dd>


<dt>x_lab</dt>
<dd><p>(<code>string</code>)<br> x-axis label.</p></dd>


<dt>y_lab</dt>
<dd><p>(<code>string</code>)<br> y-axis label.</p></dd>


<dt>title</dt>
<dd><p>(<code>string</code>)<br> plot title.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A HermesDataTopGenes object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p>The data frame is sorted in descending order of <code>expression</code> and only the top
entries according to the selection criteria are included.</p></li>
<li><p>Note that exactly one of the arguments <code>n_top</code> and <code>min_threshold</code> must be
provided.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>autoplot(HermesDataTopGenes)</code>: Creates a bar plot from a HermesDataTopGenes object,
where the y axis shows the expression statistics for each of the top genes
on the x-axis.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">hermes_data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default uses average of raw counts across samples to rank genes.</span></span></span>
<span class="r-in"><span><span class="fu">top_genes</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              expression         name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:2335   390085.60  GeneID:2335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:79026  302684.20 GeneID:79026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:4627    60247.10  GeneID:4627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:667     59502.90   GeneID:667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:26986   58479.75 GeneID:26986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:6218    57782.15  GeneID:6218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:6205    50484.85  GeneID:6205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:811     42460.70   GeneID:811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:23215   41407.95 GeneID:23215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:4035    35884.20  GeneID:4035</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Instead of showing top 10 genes, can also set a minimum threshold on average counts.</span></span></span>
<span class="r-in"><span><span class="fu">top_genes</span><span class="op">(</span><span class="va">object</span>, n_top <span class="op">=</span> <span class="cn">NULL</span>, min_threshold <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              expression         name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:2335   390085.60  GeneID:2335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:79026  302684.20 GeneID:79026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:4627    60247.10  GeneID:4627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:667     59502.90   GeneID:667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:26986   58479.75 GeneID:26986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:6218    57782.15  GeneID:6218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:6205    50484.85  GeneID:6205</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can also use the maximum of raw counts across samples, by specifying a different</span></span></span>
<span class="r-in"><span><span class="co"># summary statistics function.</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">top_genes</span><span class="op">(</span><span class="va">object</span>, summary_fun <span class="op">=</span> <span class="va">rowMax</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally we can produce barplots based on the results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">result</span>, title <span class="op">=</span> <span class="st">"My top genes"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="top_genes-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">result</span>, y_lab <span class="op">=</span> <span class="st">"Counts"</span>, title <span class="op">=</span> <span class="st">"My top genes"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="top_genes-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daniel Sabanés Bové, Namrata Bhatia, Stefanie Bienert, Benoit Falquet, Haocheng Li, Jeff Luong, Lyndsee Midori Zhang, Simona Rossomanno, Tim Treis, Mark Yan, Naomi Chang, Chendi Liao, Carolyn Zhang, Joseph N. Paulson, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

