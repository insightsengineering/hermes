<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>limma/voom Differential Expression Analysis — h_diff_expr_voom • hermes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="limma/voom Differential Expression Analysis — h_diff_expr_voom">
<meta name="description" content="
This helper functions performs the differential expression analysis with the voom
method from the limma package (via limma::voom(), limma::lmFit() and limma::eBayes())
for given counts in a AnyHermesData object and a corresponding design matrix.">
<meta property="og:description" content="
This helper functions performs the differential expression analysis with the voom
method from the limma package (via limma::voom(), limma::lmFit() and limma::eBayes())
for given counts in a AnyHermesData object and a corresponding design matrix.">
<meta property="og:image" content="https://insightsengineering.github.io/hermes/logo.png">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hermes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.2.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hermes.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/hermes/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/hermes/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/hermes/v1.7.1">v1.7.1</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/hermes"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>
<code>limma</code>/voom Differential Expression Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/hermes/blob/main/R/differential.R" class="external-link"><code>R/differential.R</code></a></small>
      <div class="d-none name"><code>h_diff_expr_voom.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This helper functions performs the differential expression analysis with the voom
method from the <code>limma</code> package (via <code><a href="https://rdrr.io/pkg/limma/man/voom.html" class="external-link">limma::voom()</a></code>, <code><a href="https://rdrr.io/pkg/limma/man/lmFit.html" class="external-link">limma::lmFit()</a></code> and <code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">limma::eBayes()</a></code>)
for given counts in a <a href="HermesData-class.html">AnyHermesData</a> object and a corresponding <code>design</code> matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">h_diff_expr_voom</span><span class="op">(</span><span class="va">object</span>, <span class="va">design</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>


<dl>
<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a>
</dt>
<dd><p>(<code>AnyHermesData</code>)<br> input.</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a>
</dt>
<dd><p>(<code>matrix</code>)<br> design matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a>
</dt>
<dd><p>additional arguments internally passed to <code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">limma::eBayes()</a></code> (<code>robust</code>, <code>trend</code>, <code>proportion</code>,
<code>winsor.tail.p</code>, <code>stdev.coef.lim</code>).</p></dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
    <p>A data frame with columns <code>log2_fc</code> (estimated log2 fold change),
<code>stat</code> (moderated t-statistic), <code>p_val</code> (raw p-value), <code>adj_p_pval</code> (Benjamini-Hochberg adjusted p-value).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
    <p>limma_packagehermes</p>
<p>voom_methodhermes</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">hermes_data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the design matrix corresponding to the factor of interest.</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">SEX</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then perform the differential expression analysis.</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">h_diff_expr_voom</span><span class="op">(</span><span class="va">object</span>, <span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  log2_fc      stat        p_val adj_p_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:8000   -2.3200712 -4.239244 0.0004209192 0.9118348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:51227  -1.0467295 -4.032550 0.0006788432 0.9118348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:344558  1.6896266  3.824046 0.0010993677 0.9118348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:51575  -0.7760844 -3.746293 0.0013155805 0.9118348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:151242 -3.4358998 -3.570103 0.0019741997 0.9118348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:8904   -0.6100354 -3.542864 0.0021017199 0.9118348</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sometimes we might want to specify method details.</span></span></span>
<span class="r-in"><span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu">h_diff_expr_voom</span><span class="op">(</span><span class="va">object</span>, <span class="va">design</span>, trend <span class="op">=</span> <span class="cn">TRUE</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  log2_fc      stat        p_val adj_p_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:8000   -2.3200712 -3.848050 0.0008857274 0.8995289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:51227  -1.0467295 -3.724654 0.0011933484 0.8995289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:344558  1.6896266  3.684191 0.0013155791 0.8995289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:51575  -0.7760844 -3.498308 0.0020551283 0.8995289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:151242 -3.4358998 -3.441687 0.0023525055 0.8995289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneID:123036  2.9002547  3.431263 0.0024329189 0.8995289</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanés Bové, Namrata Bhatia, Stefanie Bienert, Benoit Falquet, Haocheng Li, Jeff Luong, Lyndsee Midori Zhang, Alex Richardson, Simona Rossomanno, Tim Treis, Mark Yan, Naomi Chang, Chendi Liao, Carolyn Zhang, Joseph N. Paulson, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
